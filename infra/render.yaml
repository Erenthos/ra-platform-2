# =============================================
# Render Deployment Configuration
# Unified App: Backend (API + Socket.IO) + Frontend (Next.js)
# =============================================

services:
  - type: web
    name: ra-platform
    env: node
    plan: starter
    region: oregon   # or singapore / frankfurt â€” choose nearest to your users

    # ðŸ‘‡ The repository location (keep root as is)
    repo: https://github.com/YOUR_GITHUB_USERNAME/ra-platform-2
    branch: main

    # ðŸ‘‡ Root-level commands â€” builds frontend & backend together
    buildCommand: |
      npm install
      cd backend && npm install && npm run build
      cd ../frontend && npm install && npm run export
      echo "âœ… Build complete for both backend and frontend"

    startCommand: |
      cd backend && npm run start

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: JWT_ACCESS_TOKEN_SECRET
        sync: false
      - key: JWT_REFRESH_TOKEN_SECRET
        sync: false
      - key: PORT
        value: 4000
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_API_URL
        value: https://ra-platform.onrender.com
